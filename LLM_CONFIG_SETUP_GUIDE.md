# AIverse 大模型配置管理系统

## 🎯 功能概述

AIverse 大模型配置管理系统允许管理员通过前端界面配置和管理各种AI大模型，包括：
- **模型配置管理**：添加、编辑、删除模型配置
- **API密钥管理**：安全存储和管理API密钥
- **使用统计监控**：实时监控模型使用情况和成本
- **连接测试**：验证模型API连接
- **成本分析**：详细的使用成本分析和趋势

## 🚀 快速开始

### 1. 数据库初始化

首先初始化大模型配置数据库：

```bash
npm run setup:llm-config
```

这将创建必要的数据库表和预置一些常用的模型配置。

### 2. 访问管理后台

1. 启动开发服务器：
   ```bash
   npm run dev
   ```

2. 访问管理员后台：
   ```
   http://localhost:3007/zh/admin
   ```

3. 使用管理员密码登录：
   ```
   用户名: admin
   密码: aiverse-admin-2024
   ```

4. 点击 "大模型配置" 标签页

### 3. 配置模型

系统预置了以下模型：

#### OpenAI 模型
- **GPT-4o** - 最新的GPT-4优化模型
- **GPT-4 Turbo** - 高性能GPT-4模型
- **GPT-3.5 Turbo** - 快速且经济的模型

#### Anthropic 模型  
- **Claude 3.5 Sonnet** - 最新的Claude模型（默认）
- **Claude 3 Opus** - Claude最强大的模型
- **Claude 3 Haiku** - Claude最快速的模型

#### Google 模型
- **Gemini Pro** - Google的高性能多模态模型
- **Gemini Pro Vision** - Google的视觉理解模型

## 🔧 模型配置步骤

### 1. 编辑现有模型配置

1. 在模型列表中找到要配置的模型
2. 点击 "编辑" 按钮（铅笔图标）
3. 填入相应的API密钥和其他参数
4. 点击 "更新" 保存配置

### 2. 添加新模型

1. 点击 "添加模型" 按钮
2. 填写模型信息：
   - **提供商**：选择模型提供商
   - **模型名称**：人类可读的模型名称
   - **模型ID**：API调用时使用的模型标识符
   - **显示名称**：在界面中显示的名称
   - **API Key**：模型的API密钥
   - **成本设置**：输入/输出token的成本
   - **功能支持**：勾选模型支持的功能
3. 点击 "创建" 保存配置

### 3. 测试模型连接

对于每个配置的模型，可以点击 "测试连接" 按钮验证：
- API密钥是否正确
- 网络连接是否正常
- 模型是否可用
- 响应时间

### 4. 设置默认模型

- 点击模型旁边的星形图标设置为默认模型
- 默认模型将用于系统的AI功能

## 📊 使用统计监控

### 统计概览
在"使用统计"标签页可以查看：
- **总请求数**：所有模型的总请求次数
- **总Token数**：使用的token总量
- **总成本**：累计使用成本
- **活跃模型**：当前在使用的模型数量

### 成本分析
- **成本分布**：各模型的成本占比
- **使用趋势**：最近30天的使用趋势
- **详细日志**：每次API调用的详细记录

## 🔐 安全特性

### API密钥加密
- 所有API密钥使用AES-256-CBC加密存储
- 密钥在传输过程中始终加密
- 支持密钥可见性切换

### 访问控制
- 仅管理员可以访问模型配置
- 所有API都需要管理员认证
- 操作日志记录

## 🛠️ 环境变量配置

在 `.env.local` 文件中配置：

```env
# 数据库配置（复用SEO监控数据库）
SEO_DB_HOST=localhost
SEO_DB_PORT=3306
SEO_DB_USER=root
SEO_DB_PASSWORD=your_password
SEO_DB_NAME=aiverse_seo

# 加密密钥（用于API密钥加密）
ENCRYPTION_KEY=your-32-character-encryption-key

# 管理员认证
ADMIN_PASSWORD_HASH=your_hashed_password
```

## 📋 支持的模型配置

### 基础信息
- **提供商**：模型提供商标识
- **模型名称**：人类可读的名称
- **模型ID**：API调用标识符
- **显示名称**：界面显示名称
- **描述**：模型说明

### API配置
- **API端点**：自定义API端点URL
- **API密钥**：访问密钥（加密存储）
- **API版本**：指定API版本

### 模型参数
- **最大Tokens**：单次请求最大token数
- **温度**：创造性控制参数
- **Top P**：核心采样参数
- **频率惩罚**：重复词惩罚
- **存在惩罚**：主题转换控制

### 功能支持
- **流式输出**：是否支持实时流式响应
- **函数调用**：是否支持工具/函数调用
- **视觉理解**：是否支持图像理解
- **代码生成**：是否擅长代码生成

### 成本配置
- **输入成本**：每1K输入tokens的成本
- **输出成本**：每1K输出tokens的成本
- **速率限制**：每分钟请求/token限制

## 🔄 使用流程

### 日常使用
1. **配置模型**：添加和配置需要的AI模型
2. **设置默认**：选择一个作为默认模型
3. **监控使用**：定期查看使用统计和成本
4. **优化成本**：根据使用情况调整模型选择

### 故障排除
1. **连接失败**：检查API密钥和网络连接
2. **成本异常**：查看使用日志分析异常调用
3. **性能问题**：监控响应时间和成功率

## 🎯 最佳实践

### 安全建议
- 定期轮换API密钥
- 使用强加密密钥
- 限制管理员访问权限
- 监控异常使用模式

### 成本优化
- 为不同用途配置不同模型
- 监控成本趋势
- 设置合适的token限制
- 优先使用性价比高的模型

### 性能优化
- 根据任务选择合适的模型
- 配置合理的速率限制
- 监控响应时间
- 使用支持流式输出的模型

## 📞 技术支持

如果遇到问题，请检查：
1. 数据库连接是否正常
2. 环境变量是否配置正确
3. API密钥是否有效
4. 网络连接是否稳定

更多技术详情请查看源码中的注释和文档。